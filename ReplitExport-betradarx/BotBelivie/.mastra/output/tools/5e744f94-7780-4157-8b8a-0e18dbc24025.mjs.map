{"version":3,"file":"5e744f94-7780-4157-8b8a-0e18dbc24025.mjs","sources":["../../../src/mastra/tools/sendTelegramMessage.ts"],"sourcesContent":["import { createTool } from \"@mastra/core/tools\";\nimport { z } from \"zod\";\nimport TelegramBot from \"node-telegram-bot-api\";\n\nexport const sendTelegramMessage = createTool({\n  id: \"send-telegram-message\",\n  description: \"Sends a message via Telegram Bot API\",\n  \n  inputSchema: z.object({\n    message: z.string().describe(\"The message to send\"),\n    parseMode: z\n      .enum([\"HTML\", \"Markdown\"])\n      .optional()\n      .describe(\"Message formatting mode\"),\n  }),\n  \n  outputSchema: z.object({\n    success: z.boolean(),\n    messageId: z.number().optional(),\n    error: z.string().optional(),\n  }),\n  \n  execute: async ({ context, mastra }) => {\n    const logger = mastra?.getLogger();\n    logger?.info(\"üîß [sendTelegramMessage] Starting execution\");\n    \n    const token = process.env.TELEGRAM_BOT_TOKEN;\n    const chatId = process.env.TELEGRAM_CHAT_ID;\n    \n    if (!token || !chatId) {\n      logger?.error(\"‚ùå [sendTelegramMessage] Missing credentials\", {\n        hasToken: !!token,\n        hasChatId: !!chatId,\n      });\n      return {\n        success: false,\n        error: \"TELEGRAM_BOT_TOKEN or TELEGRAM_CHAT_ID not configured\",\n      };\n    }\n    \n    try {\n      const bot = new TelegramBot(token);\n      logger?.info(\"üì§ [sendTelegramMessage] Sending message\", {\n        messageLength: context.message.length,\n        parseMode: context.parseMode,\n      });\n      \n      const options: any = {};\n      if (context.parseMode) {\n        options.parse_mode = context.parseMode;\n      }\n      \n      const result = await bot.sendMessage(chatId, context.message, options);\n      \n      logger?.info(\"‚úÖ [sendTelegramMessage] Message sent successfully\", {\n        messageId: result.message_id,\n      });\n      \n      return {\n        success: true,\n        messageId: result.message_id,\n      };\n    } catch (error: any) {\n      logger?.error(\"‚ùå [sendTelegramMessage] Error sending message\", {\n        error: error.message,\n      });\n      \n      return {\n        success: false,\n        error: error.message || \"Unknown error occurred\",\n      };\n    }\n  },\n});\n"],"names":[],"mappings":";;;;AAIO,MAAM,sBAAsB,UAAA,CAAW;AAAA,EAC5C,EAAA,EAAI,uBAAA;AAAA,EACJ,WAAA,EAAa,sCAAA;AAAA,EAEb,WAAA,EAAa,EAAE,MAAA,CAAO;AAAA,IACpB,OAAA,EAAS,CAAA,CAAE,MAAA,EAAO,CAAE,SAAS,qBAAqB,CAAA;AAAA,IAClD,SAAA,EAAW,CAAA,CACR,IAAA,CAAK,CAAC,MAAA,EAAQ,UAAU,CAAC,CAAA,CACzB,QAAA,EAAS,CACT,QAAA,CAAS,yBAAyB;AAAA,GACtC,CAAA;AAAA,EAED,YAAA,EAAc,EAAE,MAAA,CAAO;AAAA,IACrB,OAAA,EAAS,EAAE,OAAA,EAAQ;AAAA,IACnB,SAAA,EAAW,CAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,IAC/B,KAAA,EAAO,CAAA,CAAE,MAAA,EAAO,CAAE,QAAA;AAAS,GAC5B,CAAA;AAAA,EAED,OAAA,EAAS,OAAO,EAAE,OAAA,EAAS,QAAO,KAAM;AACtC,IAAA,MAAM,MAAA,GAAS,QAAQ,SAAA,EAAU;AACjC,IAAA,MAAA,EAAQ,KAAK,oDAA6C,CAAA;AAE1D,IAAA,MAAM,KAAA,GAAQ,QAAQ,GAAA,CAAI,kBAAA;AAC1B,IAAA,MAAM,MAAA,GAAS,QAAQ,GAAA,CAAI,gBAAA;AAE3B,IAAA,IAAI,CAAC,KAAA,IAAS,CAAC,MAAA,EAAQ;AACrB,MAAA,MAAA,EAAQ,MAAM,kDAAA,EAA+C;AAAA,QAC3D,QAAA,EAAU,CAAC,CAAC,KAAA;AAAA,QACZ,SAAA,EAAW,CAAC,CAAC;AAAA,OACd,CAAA;AACD,MAAA,OAAO;AAAA,QACL,OAAA,EAAS,KAAA;AAAA,QACT,KAAA,EAAO;AAAA,OACT;AAAA,IACF;AAEA,IAAA,IAAI;AACF,MAAA,MAAM,GAAA,GAAM,IAAI,WAAA,CAAY,KAAK,CAAA;AACjC,MAAA,MAAA,EAAQ,KAAK,iDAAA,EAA4C;AAAA,QACvD,aAAA,EAAe,QAAQ,OAAA,CAAQ,MAAA;AAAA,QAC/B,WAAW,OAAA,CAAQ;AAAA,OACpB,CAAA;AAED,MAAA,MAAM,UAAe,EAAC;AACtB,MAAA,IAAI,QAAQ,SAAA,EAAW;AACrB,QAAA,OAAA,CAAQ,aAAa,OAAA,CAAQ,SAAA;AAAA,MAC/B;AAEA,MAAA,MAAM,SAAS,MAAM,GAAA,CAAI,YAAY,MAAA,EAAQ,OAAA,CAAQ,SAAS,OAAO,CAAA;AAErE,MAAA,MAAA,EAAQ,KAAK,wDAAA,EAAqD;AAAA,QAChE,WAAW,MAAA,CAAO;AAAA,OACnB,CAAA;AAED,MAAA,OAAO;AAAA,QACL,OAAA,EAAS,IAAA;AAAA,QACT,WAAW,MAAA,CAAO;AAAA,OACpB;AAAA,IACF,SAAS,KAAA,EAAY;AACnB,MAAA,MAAA,EAAQ,MAAM,oDAAA,EAAiD;AAAA,QAC7D,OAAO,KAAA,CAAM;AAAA,OACd,CAAA;AAED,MAAA,OAAO;AAAA,QACL,OAAA,EAAS,KAAA;AAAA,QACT,KAAA,EAAO,MAAM,OAAA,IAAW;AAAA,OAC1B;AAAA,IACF;AAAA,EACF;AACF,CAAC;;;;"}