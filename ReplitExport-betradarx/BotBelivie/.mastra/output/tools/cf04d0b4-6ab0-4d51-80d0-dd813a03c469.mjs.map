{"version":3,"file":"cf04d0b4-6ab0-4d51-80d0-dd813a03c469.mjs","sources":["../../../src/mastra/tools/calculatePressure.ts"],"sourcesContent":["import { createTool } from \"@mastra/core/tools\";\nimport { z } from \"zod\";\n\nexport const calculatePressure = createTool({\n  id: \"calculate-pressure\",\n  description: \"Calculates pressure metrics from match statistics (attacks, shots, corners)\",\n  \n  inputSchema: z.object({\n    stats: z.array(z.any()).describe(\"Match statistics from API-Football\"),\n  }),\n  \n  outputSchema: z.object({\n    pressHome: z.number(),\n    pressAway: z.number(),\n    pressTotal: z.number(),\n    pressDiff: z.number(),\n    attacksHome: z.number(),\n    attacksAway: z.number(),\n    shotsHome: z.number(),\n    shotsAway: z.number(),\n    cornersHome: z.number(),\n    cornersAway: z.number(),\n    success: z.boolean(),\n    error: z.string().optional(),\n  }),\n  \n  execute: async ({ context, mastra }) => {\n    const logger = mastra?.getLogger();\n    logger?.info(\"üîß [calculatePressure] Starting execution\");\n    \n    try {\n      if (!context.stats || context.stats.length < 2) {\n        logger?.error(\"‚ùå [calculatePressure] Insufficient stats data\", {\n          statsLength: context.stats?.length || 0,\n        });\n        return {\n          pressHome: 0,\n          pressAway: 0,\n          pressTotal: 0,\n          pressDiff: 0,\n          attacksHome: 0,\n          attacksAway: 0,\n          shotsHome: 0,\n          shotsAway: 0,\n          cornersHome: 0,\n          cornersAway: 0,\n          success: false,\n          error: \"Insufficient statistics data\",\n        };\n      }\n      \n      const homeStats = context.stats[0];\n      const awayStats = context.stats[1];\n      \n      const getStatValue = (team: any, key: string): number => {\n        const statistics = team.statistics || [];\n        for (const item of statistics) {\n          if (item.type?.toLowerCase() === key.toLowerCase()) {\n            const val = item.value;\n            if (val === null || val === undefined) return 0;\n            if (typeof val === \"number\") return val;\n            if (typeof val === \"string\") return parseInt(val, 10) || 0;\n          }\n        }\n        return 0;\n      };\n      \n      const attacksHome = getStatValue(homeStats, \"Total attacks\");\n      const attacksAway = getStatValue(awayStats, \"Total attacks\");\n      const shotsHome = getStatValue(homeStats, \"Shots on Goal\");\n      const shotsAway = getStatValue(awayStats, \"Shots on Goal\");\n      const cornersHome = getStatValue(homeStats, \"Corner Kicks\");\n      const cornersAway = getStatValue(awayStats, \"Corner Kicks\");\n      \n      logger?.info(\"üìä [calculatePressure] Extracted stats\", {\n        attacksHome,\n        attacksAway,\n        shotsHome,\n        shotsAway,\n        cornersHome,\n        cornersAway,\n      });\n      \n      const pressHome = attacksHome * 0.5 + shotsHome * 1.5 + cornersHome * 0.8;\n      const pressAway = attacksAway * 0.5 + shotsAway * 1.5 + cornersAway * 0.8;\n      const pressTotal = pressHome + pressAway;\n      const pressDiff = Math.abs(pressHome - pressAway);\n      \n      logger?.info(\"‚úÖ [calculatePressure] Calculated pressure metrics\", {\n        pressHome,\n        pressAway,\n        pressTotal,\n        pressDiff,\n      });\n      \n      return {\n        pressHome,\n        pressAway,\n        pressTotal,\n        pressDiff,\n        attacksHome,\n        attacksAway,\n        shotsHome,\n        shotsAway,\n        cornersHome,\n        cornersAway,\n        success: true,\n      };\n    } catch (error: any) {\n      logger?.error(\"‚ùå [calculatePressure] Error calculating pressure\", {\n        error: error.message,\n      });\n      \n      return {\n        pressHome: 0,\n        pressAway: 0,\n        pressTotal: 0,\n        pressDiff: 0,\n        attacksHome: 0,\n        attacksAway: 0,\n        shotsHome: 0,\n        shotsAway: 0,\n        cornersHome: 0,\n        cornersAway: 0,\n        success: false,\n        error: error.message || \"Unknown error occurred\",\n      };\n    }\n  },\n});\n"],"names":[],"mappings":"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"}